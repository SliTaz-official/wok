# SliTaz package receipt.

PACKAGE="dropbox"
VERSION="0.6.487"
CATEGORY="network"
SHORT_DESC="Dropbox online file storage tool"
MAINTAINER="pankso@slitaz.org"
DEPENDS="python"
TARBALL="$PACKAGE-lnx.x86-$VERSION.tar.gz"
WEB_SITE="http://www.getdropbox.com/"
WGET_URL="http://dl.getdropbox.com/u/17/$TARBALL"

# Rules to configure and make the package.
compile_rules()
{
	mkdir -p $src && cd $src
	mkdir -p _pkg/usr/lib _pkg/usr/bin
	mv ../.dropbox-dist _pkg/usr/lib/dropbox 2>/dev/null
	cp -a ../stuff/dropboxd _pkg/usr/lib/dropbox
	cd _pkg/usr/bin
	rm -f dropboxd nautilus
	ln -s ../lib/dropbox/dropboxd .
	ln -s /usr/bin/pcmanfm nautilus
}

# Rules to gen a SliTaz package suitable for Tazpkg.
genpkg_rules()
{
	cp -a $_pkg/* $fs
}

post_install()
{
	AUTOSTART_SCRIPT="$1/etc/xdg/openbox/autostart.sh"
	if ! grep -q "^#dropboxd" $AUTOSTART_SCRIPT; then
	echo -n "Adding Dropbox to Openbox autostart script... "
	cat >> $AUTOSTART_SCRIPT << EOT

# Start the Dropbox online file storage daemon.'
#dropboxd &
EOT
	status
fi
}
