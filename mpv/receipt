# SliTaz package receipt.

PACKAGE="mpv"
VERSION="0.17.0"
CATEGORY="multimedia"
SHORT_DESC="Video player based on ffmpeg & mplayer2"
MAINTAINER="jurijlunjov@yandex.ru"
LICENSE="GPL2"
TARBALL="$PACKAGE-$VERSION.tar.gz"
WEB_SITE="http://mpv.io"
WGET_URL="https://github.com/mpv-player/mpv/archive/v$VERSION.tar.gz"
WAFTOOL="waf-1.8.12"
EXTRA_SOURCE_FILES="$WAFTOOL"

DEPENDS="xorg-server xorg-libXv xorg-libXinerama xorg-libXss util-linux-uuid \
libarchive alsa-lib enca fribidi lua ffmpeg openal"
BUILD_DEPENDS="wget xorg-dev xorg-libXv-dev xorg-libXss-dev lua-dev ffmpeg-dev \
libarchive-dev enca-dev fribidi-dev alsa-lib-dev openal-dev"

# Rules to configure and make the package.
compile_rules()
{
	[ -s $SOURCES_REPOSITORY/$WAFTOOL ] || wget -P $SOURCES_REPOSITORY \
		http://www.freehackers.org/~tnagy/release/$WAFTOOL
	install -m 755 $SOURCES_REPOSITORY/$WAFTOOL waf
	./bootstrap.py
	./waf configure \
		--prefix=/usr \
		--confdir=/etc/mpv \
		--enable-openal \
		--enable-zsh-comp \
		--disable-debug \
		--enable-libarchive \
		--disable-oss-audio \
		--disable-libass \
		--enable-libmpv-shared	
	
	./waf build
	./waf install --destdir=$DESTDIR
}

# Rules to gen a SliTaz package suitable for Tazpkg.
genpkg_rules()
{
	cp -a $install/* $fs
}
