# SliTaz package receipt.

PACKAGE="aufs-utils"
VERSION="20110124"
CATEGORY="system-tools"
SHORT_DESC="The aufs utils."
MAINTAINER="pankso@slitaz.org"
DEPENDS="aufs"
BUILD_DEPENDS="git linux-module-headers"
WEB_SITE="http://aufs.sourceforge.net/"

# Rules to configure and make the package.
compile_rules()
{
	[ -d "$PACKAGE-$VERSION" ] && rm -rf $PACKAGE-$VERSION
	TARBALL=$SOURCES_REPOSITORY/$PACKAGE-$VERSION.tar.lzma
	if [ -f $TARBALL ]; then
		unlzma -c $TARBALL | tar xf -
		cd $src && git checkout origin/aufs2.1
	else
		git clone http://git.c3sl.ufpr.br/pub/scm/aufs/aufs2-util.git $PACKAGE-$VERSION
		tar cf - $PACKAGE-$VERSION | lzma e $TARBALL -si
		cd $src && git checkout origin/aufs2.1
	fi

		KERNEL_VERSION=`grep  ^VERSION= $WOK/linux/receipt | cut -d "=" -f2 | sed -e 's/"//g'`
	cd $src
	sed -i 's/-m 644 -T/-m 644/' Makefile
	make && 
	make DESTDIR=$PWD/_pkg install
}

# Rules to gen a SliTaz package suitable for Tazpkg.
genpkg_rules()
{
	mkdir -p $fs/usr
	cp -a $_pkg/sbin $fs
	cp -a $_pkg/usr/bin $fs/usr
}

