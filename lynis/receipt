# SliTaz package receipt.

PACKAGE="lynis"
VERSION="2.6.6"
CATEGORY="security"
SHORT_DESC="Security and system auditing tool."
MAINTAINER="pascal.bellard@slitaz.org"
LICENSE="GPL3"
WEB_SITE="https://cisofy.com/lynis/"
TARBALL="$PACKAGE-$VERSION.tar.gz"
WGET_URL="https://downloads.cisofy.com/lynis/$TARBALL"

DEPENDS=""
BUILD_DEPENDS=""
SUGGESTED="wget procps perl findutils rpm4"

# Rules to gen a SliTaz package suitable for Tazpkg.
genpkg_rules()
{
	mkdir -p $fs/usr/share $fs/usr/sbin 
	mkdir -p $install/usr/share/man $install/usr/share/doc
	cp $src/[A-Z]* $install/usr/share/doc
	cp $src/lynis.8 $install/usr/share/man
	cp -a $src $fs/usr/share/lynis
	sed -i "s!| grep \"\\^GNU Wget\" | awk '{ print \$3 !\
2>\\&1 | awk '/^GNU Wget/{ print $3 }/^BusyBox/{ print \$1 \"/\" substr(\$2,2)!\
" $fs/usr/share/lynis/include/binaries
	cat > $fs/usr/sbin/lynis <<EOT
#!/bin/sh

cd /usr/share/lynis
exec ./lynis "\$@"
EOT
	chown -R root.root $fs/usr/s*/lynis 
	chmod +x $fs/usr/sbin/lynis
}
