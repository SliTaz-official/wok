# SliTaz package receipt.

PACKAGE="bzip2"
VERSION="1.0.4"
CATEGORY="utilities"
SHORT_DESC="High-quality data compressor."
MAINTAINER="pankso@slitaz.org"
TARBALL="$PACKAGE-$VERSION.tar.gz"
WEB_SITE="http://www.bzip.org/"
WGET_URL="http://www.bzip.org/1.0.4/$TARBALL"

# Rules to configure and make the package.
compile_rules()
{
	cd $src
	make -f Makefile-libbz2_so
	make clean
	make
}

# Rules to gen a SliTaz package suitable for Tazpkg.
genpkg_rules()
{
	mkdir -p $fs/usr/bin $fs/usr/lib
	cp -a $src/bzip2-shared $fs/usr/bin/bzip2
	cp -a $src/libbz2.so* $fs/usr/lib
	strip --strip-unneeded $fs/usr/bin/*
	strip --strip-debug $fs/usr/lib/*
	# Da bunzip2, bzcat and lib symlink.
	cd $fs/usr/bin
	ln -s bzip2 bunzip2
	ln -s bzip2 bzcat
	cd ../lib
	ln -s libbz2.so.1.0.4 libbz2.so
}

# Pre install commands for Tazpkg.
# Force remove of an eventual bzcat link to Busybox.
pre_install()
{
  local root
  root=$1
  echo "Processing post-install commands..."
  rm -f $root/usr/bin/bzcat
}
