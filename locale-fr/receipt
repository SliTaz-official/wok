# SliTaz package receipt

PACKAGE="locale-fr"
VERSION="2.0"
CATEGORY="system-tools"
SHORT_DESC="French locale pack."
MAINTAINER="pankso@slitaz.org"
DEPENDS="glibc-base"
BUILD_DEPENDS="glibc glibc-locale"
WEB_SITE="http://www.slitaz.org/"

# French messages are directly include in all packages by tazwok.
CORE_PKGS=""

LOCALE="fr"
LOCALEDEF="fr_FR"
CHARMAP="ISO-8859-1"

# Rules to configure and make the package.
compile_rules()
{
	# Ensure packages are built.
	for pkg in $CORE_PKGS
	do
		[ -d $WOK/$pkg/taz ] || tazwok cook $pkg
	done
}

# Rules to gen a SliTaz package suitable for Tazpkg.
# Genereted locale files are in /usr/lib/locale.
genpkg_rules()
{
	mkdir -p $fs/usr/share/locale/$LOCALE \
		$fs/usr/lib/locale $fs/etc/xdg \
		$fs/usr/share/slitaz/messages
	cp -a stuff/doc $fs/usr/share
	cp -a stuff/messages $fs/usr/share/slitaz/messages/$LOCALE
	cp -a stuff/openbox $fs/etc/xdg
	PKG_NAME="$PACKAGE"
	PKG_VERS="$VERSION"
	# Get the core packages messages.
	for pkg in $CORE_PKGS
	do
		[ -f $WOK/$pkg/receipt ] && . $WOK/$pkg/receipt
		if [ -d $WOK/$pkg/$PACKAGE-$VERSION/_pkg/usr/share/locale/$LOCALE ]; then
			cp -a $WOK/$pkg/$PACKAGE-$VERSION/_pkg/usr/share/locale/$LOCALE \
				$fs/usr/share/locale
		fi
	done
	PACKAGE="$PKG_NAME"
	VERSION="$PKG_VERS"
	localedef -i $LOCALEDEF -c -f $CHARMAP $fs/usr/lib/locale/$LOCALEDEF
}

# Back to C if it's the last used locale.
post_remove()
{
	if grep -q $LOCALEDEF /etc/locale.conf; then
		echo "LANG=C" > /etc/locale.conf
		echo "LC_ALL=C" >> /etc/locale.conf
	fi
}
