# SliTaz package receipt

PACKAGE="locale-zh_CN"
VERSION="4.1"
CATEGORY="system-tools"
SHORT_DESC="Chinese Simplified locale pack."
MAINTAINER="lufeng369@slitaz.org"
LICENSE="GPL3"
WEB_SITE="http://www.slitaz.org/"

WANTED="glibc slitaz-i18n xorg-libX11"
DEPENDS="glibc-base wqy-microhei"

LOCALE="zh_CN"
ADD_FLAGS=""
LXPANEL_FLAGS=""

# Rules to gen a SliTaz package suitable for Tazpkg.
genpkg_rules()
{
	. $WOK/slitaz-i18n/stuff/locale-pack.functions
	. $WOK/slitaz-i18n/stuff/locale-pack.conf
	get_locale

	# "zh_CN" locale definition based on "iso14651_t1_pinyin" locale definition file
	cp -a $WOK/glibc/install/usr/share/i18n/locales/iso14651_t1_pinyin $fs/usr/share/i18n/locales

	GCONV_MODULES="
		BIG5.so    GBBIG5.so   GBGBK.so
		UTF-32.so  GB18030.so  EUC-CN.so
		GBK.so     UTF-7.so    libGB.so"
	mkdir -p $fs/usr/bin
	mkdir -p $fs/usr/lib/gconv

	cp /usr/bin/iconv $fs/usr/bin
	for i in $GCONV_MODULES; do
		cp $WOK/glibc/install/usr/lib/gconv/$i $fs/usr/lib/gconv
	done
}

post_install()
{
	if [ -z "$1" ]; then
		echo LANG=zh_CN.UTF-8 > /etc/locale.conf
		echo Asia/Shanghai > /etc/TZ
		export TZ=Asia/Shanghai
		hwclock --hctosys
	fi
}

# Back to C if it's the last used locale.
post_remove()
{
	echo -e "LANG=C\nLC_ALL=C" > /etc/locale.conf
}
