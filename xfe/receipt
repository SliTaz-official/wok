# SliTaz package receipt.

PACKAGE="xfe"
VERSION="1.43.2"
CATEGORY="system-tools"
TAGS="file-manager"
SHORT_DESC="Xfe File manager and utility using Fox toolkit."
MAINTAINER="pankso@slitaz.org"
LICENSE="GPL2"
WEB_SITE="http://roland65.free.fr/xfe/"

TARBALL="$PACKAGE-$VERSION.tar.gz"
WGET_URL="$SF_MIRROR/$PACKAGE/$TARBALL"

SUGGESTED="adie calculator shutterbug xfe-extras xfi"
DEPENDS="fox jpeg libpng tiff xcb-util xorg-libXft"
BUILD_DEPENDS="automake fox-dev jpeg-dev libpng-dev tiff-dev 
	xcb-util-dev xorg-libXft-dev"

GENERIC_MENUS="no"

#HOST_ARCH="i486 arm"

# Handle cross compilation.
case "$ARCH" in
	i?86) BUILD_DEPENDS="$BUILD_DEPENDS intltool" ;;
	arm)
		export LDLAGS="-L/cross/$ARCH/sysroot/usr/lib" ;;
esac

current_version()
{
	wget -O - https://sourceforge.net/projects/$PACKAGE/files/ 2>/dev/null | \
	sed '/scope="row/!d;s|.*href="|"https://sourceforge.net|;q' | xargs wget -O - 2>/dev/null | \
	sed "/$PACKAGE-/!d;/tar/!d;s|.*$PACKAGE-\\(.*\\).tar.*|\\1|;q"
}

# Rules to configure and make the package.
compile_rules()
{
	ln -s /usr/bin/aclocal /usr/bin/aclocal-1.15
	ln -s /usr/bin/automake /usr/bin/automake-1.15

	# Required by freetype-dev-2.4.11
	sed -i 's|config/ftheader.h|freetype/config/ftheader.h|' configure.ac
	export	LDFLAGS="$LDFLAGS -lrt"

	./configure $CONFIGURE_ARGS &&
	make &&
	make install
}

# Rules to gen a SliTaz package suitable for Tazpkg.
genpkg_rules()
{
	mkdir -p $fs/usr/bin
	mkdir -p $fs/usr/share/xfe/icons

	cp -a $install/usr/bin/$PACKAGE		$fs/usr/bin
	cp -a $install/usr/share/xfe/xferc	$fs/usr/share/xfe
	sed -i 's/gnomeblue-theme/tango-theme/'	$fs/usr/share/xfe/xferc

	# Tango/Gnome icons theme only
	cp -a $install/usr/share/xfe/icons/tango-theme \
						$fs/usr/share/xfe/icons
	cp -a $install/usr/share/xfe/icons/gnome-theme \
						$fs/usr/share/xfe/icons	
}
