# SliTaz package receipt.

PACKAGE="eggdbus"
VERSION="0.4"
CATEGORY="development"
SHORT_DESC="A new (as compared to dbus-glib) D-Bus binding for GObject."
MAINTAINER="rcx@zoominternet.net"
DEPENDS="glibc-base glib libgio dbus dbus-glib"
BUILD_DEPENDS="slitaz-toolchain m4 autoconf automake libtool glib-dev dbus-dev dbus-glib-dev"
TARBALL="$PACKAGE-$VERSION.tar.bz2"
WEB_SITE="http://mail.gnome.org/archives/gtk-devel-list/2008-December/msg00059.html"
WGET_URL="http://cgit.freedesktop.org/~david/$PACKAGE/snapshot/$TARBALL"

# Rules to configure and make the package.
compile_rules()
{
	cd $src
	
	# autogen.sh forces some unnecessary options; remove them
	sed -i 's/gtkdocize /echo /' $src/autogen.sh || exit 1
	sed -i 's/--enable-gtk-doc//' $src/autogen.sh || exit 1
	sed -i 's/ docs/ /' $src/Makefile.am || exit 1
	sed -i 's|docs/Makefile||' $src/configure.ac || exit 1
	sed -i 's|docs/version.xml||' $src/configure.ac || exit 1
	sed -i 's|docs/man/Makefile||' $src/configure.ac || exit 1
	sed -i 's|docs/tests/Makefile||' $src/configure.ac || exit 1
	sed -i 's|docs/eggdbus/Makefile||' $src/configure.ac || exit 1
	sed -i 's|GTK_DOC_CHECK(\[1.3\])||' $src/configure.ac || exit 1
	rm -r -f $src/docs
		
    ./autogen.sh --prefix=/usr \
		--enable-gtk-doc=no \
		$CONFIGURE_ARGS  &&
    make &&
    make DESTDIR=$src/_pkg install
}

# Rules to gen a SliTaz package suitable for Tazpkg.
genpkg_rules()
{
	mkdir -p $fs/usr/lib
	cp -a $_pkg/usr/lib/*.so* $fs/usr/lib
	cp -a $_pkg/usr/bin $fs/usr
}
