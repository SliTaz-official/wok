# SliTaz package receipt.

PACKAGE="nbs"
VERSION="2007svn"
CATEGORY="network"
SHORT_DESC="Network Broadcast Sound."
MAINTAINER="pascal.bellard@slitaz.org"
WEB_SITE="http://svn.digium.com/view/nbs"


# Rules to configure and make the package.
compile_rules()
{
	mkdir $src
	cd $src
	TARBALL=$PACKAGE-$VERSION.tar.gz
	[ -f $SOURCES_REPOSITORY/$TARBALL ] && 
		tar xzf $SOURCES_REPOSITORY/$TARBALL
	for i in Makefile nbs.h nbscat.c nbscat8k nbsclient.c nbsd.c; do
		[ -f $i ] && continue
		wget http://svn.digium.com/view/nbs/trunk/$i?view=co || return 1
		mv $i\?view=co $i
		[ -f ../stuff/$i.u ] && patch -p0 <  ../stuff/$i.u
	done
	[ -f $SOURCES_REPOSITORY/$TARBALL ] ||
		tar cvzf $SOURCES_REPOSITORY/$TARBALL \
			Makefile nbs.h nbscat.c nbscat8k nbsclient.c nbsd.c
	make &&
	make DESTDIR=$PWD/_pkg install
}

# Rules to gen a SliTaz package suitable for Tazpkg.
genpkg_rules()
{
	mkdir -p $fs/usr/lib
	cp -a $_pkg/usr/bin $fs/usr
	cp -a $_pkg/usr/sbin $fs/usr
	cp -a $_pkg/usr/lib/*.so* $fs/usr/lib
	ln -s libnbs.so.1.0 $fs/usr/lib/libnbs.so.1
	# Package all nbs pkgs
	for i in $(cd $WOK; ls -d nbs-*)
	do
		tazwok genpkg $i
	done
}

