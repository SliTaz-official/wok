# SliTaz package receipt.

PACKAGE="eduke32"
VERSION="20090313"
CATEGORY="games"
SHORT_DESC="Duke Nuken shoot them up port"
MAINTAINER="mallory@sweetpeople.org"
DEPENDS="libsdl libsdl-mixer libvorbis gtk+"
BUILD_DEPENDS="libsdl-dev libsdl-mixer-dev libvorbis-dev gtk+-dev nasm"
TARBALL="$PACKAGE""_src_20090131.zip"
WEB_SITE="http://www.eduke32.com/"
WGET_URL="http://mirror.slitaz.org/sources/packages/e/$TARBALL"
TAGS="shooting"

# Rules to configure and make the package.
compile_rules()
{
	cd $src
	[ -s $SOURCES_REPOSITORY/duke3d.grp ] ||
    	wget http://mirror.slitaz.org/sources/packages/d/duke3d.grp -P $SOURCES_REPOSITORY
	[ -s $SOURCES_REPOSITORY/eduke32_src_20090313.diff ] ||
    	wget http://mirror.slitaz.org/sources/packages/e/eduke32_src_20090313.diff -P $SOURCES_REPOSITORY
   	patch -p1 < $SOURCES_REPOSITORY/eduke32_src_20090313.diff
	make -j 4 || return 1
    	mkdir $src/_pkg
    	cp eduke32 mapster32 $src/_pkg
}

# Rules to gen a SliTaz package suitable for Tazpkg.
genpkg_rules()
{
	echo "Building package tree"
	mkdir -p $fs/usr/bin \
		$fs/usr/share/games/eduke32 \
		$fs/usr/share/applications \
		$fs/usr/share/pixmaps \

	echo "Copying package files"
	cp -a $_pkg/eduke32 $_pkg/mapster32 $fs/usr/bin
	
	echo "Downloading game data"
	cp $SOURCES_REPOSITORY/duke3d.grp $fs/usr/share/games/eduke32/duke3d.grp
	
	echo "Copying metadata"
	cp $stuff/eduke32.desktop $fs/usr/share/applications
	cp $stuff/eduke32.png $fs/usr/share/pixmaps
}


