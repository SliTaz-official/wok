# SliTaz package receipt.

PACKAGE="nvidia-glx"
VERSION="177.82"
CATEGORY="non-free"
SHORT_DESC="NVIDIA X.org libraries and utilities"
MAINTAINER="b1+slitaz@nagel.org"
DEPENDS="nvidia xorg xorg-server"
WANTED="nvidia"
WEB_SITE="http://www.nvidia.com"
PROVIDE="libgl:nvidia"

# Rules to gen a SliTaz package suitable for Tazpkg.
genpkg_rules()
{
  mkdir -p $fs/usr/{bin,lib/tls}
  mkdir -p $fs/usr/lib/X11/modules/{extensions,drivers}
  
  install -m755 $src/usr/lib/lib{GL,GLcore,nvidia-cfg,nvidia-tls}.so.$VERSION $fs/usr/lib
  install -m755 $src/usr/{lib/tls,X11R6/lib}/lib*.so.$VERSION $fs/usr/lib/tls
  install -m755 $src/usr/X11R6/lib/modules/drivers/nvidia_drv.so $fs/usr/lib/X11/modules/drivers
  install -m755 $src/usr/X11R6/lib/modules/extensions/libglx.so.$VERSION $fs/usr/lib/X11/modules/extensions
  
  install -m755 $src/usr/bin/nvidia-xconfig $fs/usr/bin/

  find $fs/ -name \*.so.$VERSION | while read lib; do
    libname=$(basename "$lib")
    (cd $(dirname "$lib") &&
    ln -s $libname ${libname%.$VERSION} &&
    ln -s $libname ${libname%.$VERSION}.1)
  done  
}
