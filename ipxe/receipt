# SliTaz package receipt.

PACKAGE="ipxe"
VERSION="1.0.0-20121001"
GIT_TAG="d23db2848813a9d872e1d71272e7f41df7d0d01c"
CATEGORY="system-tools"
SHORT_DESC="Open source network boot firmware."
MAINTAINER="pascal.bellard@slitaz.org"
WEB_SITE="http://ipxe.org/"
TARBALL="$PACKAGE-$VERSION.tar.bz2"
WGET_URL="https://git.ipxe.org/ipxe.git/snapshot/$GIT_TAG.tar.bz2"

DEPENDS=""
BUILD_DEPENDS="perl wget"

# Rules to configure and make the package.
compile_rules()
{
	cd $src/src
	make bin/undionly.kpxe bin/ipxe.lkrn
}

# Rules to gen a SliTaz package suitable for Tazpkg.
genpkg_rules()
{
	mkdir $fs/boot
	cp -a $src/src/bin/ipxe.lkrn $fs/boot/ipxe
	cat > $fs/boot/ipxe.cmd <<EOT
#!ipxe

prompt --key 0x02 --timeout 3000 Press Ctrl-B for the iPXE command line... && goto shell
dhcp
chain http://mirror.slitaz.org/pxe/ipxe.php ||
chain http://mirror.switch.ch/ftp/mirror/pxe/ipxe.php ||
chain http://download.tuxfamily.org/slitaz/pxe/ipxe.php
:shell
shell
EOT
}
