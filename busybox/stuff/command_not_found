#!/bin/sh

ZLIST=/var/lib/tazpkg/files.list.lzma
LIST=/tmp/command-list
[ ! $LIST -nt $ZLIST ] && unlzma <$ZLIST | grep -E '(usr/games/|bin/)' >$LIST && chmod 666 $LIST

lookup() {
	grep -s "/$2$1$" $LIST | while read pkg file; do
		cat <<EOT
Command '$1' not found, but can be installed as root with:

tazpkg -gi ${pkg%:}
${2:+$2$1}
EOT
		break
	done
}

MSG="$(lookup "$1")"
[ "$MSG" ] || MSG="$(lookup "$1" get-)"
echo "${MSG:-${SHELL##*/}: $1: not found}"
