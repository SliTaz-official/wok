# SliTaz package receipt.

PACKAGE="cross-arm-gcc"
VERSION="4.5.2"
CATEGORY="system-tools"
SHORT_DESC="Cross compiler for targeting ARM platform."
MAINTAINER="pankso@slitaz.org"
SOURCE="gcc-core"
WEB_SITE="http://www.gnu.org/software/binutils/"
TARBALL="$SOURCE-$VERSION.tar.bz2"
WGET_URL="$GNU_MIRROR/$SOURCE/$TARBALL"

DEPENDS="cross-arm-binutils mpc-library"
BUILD_DEPENDS="slitaz-toolchain cross-arm-binutils gmp gmp-dev mpfr mpfr-dev \
mpc-library"

# The goal here is to build an ARM cross toolchain who we let build code for
# the target arch from an i486 build/host. To build a cross toolchain we use
# the native i486 GCC compiler so set --build and --host to HOST_SYSTEM.
CROSS_TARGET="arm-slitaz-linux"
CROSS_TRIPLET="--build=$HOST_SYSTEM --host=$HOST_SYSTEM --target=$CROSS_TARGET"

# Rules to configure and make the package.
compile_rules()
{
	cd $src
	mkdir -p ../build && cd ../build
	$src/configure \
		--libexecdir=/usr/lib \
		--disable-nls \
		--disable-threads \
		--disable-multilib \
		--disable-bootstarp \
		--enable-languages=c \
		--with-cpu=arm9 \
		$CROSS_TRIPLET &&
	make \
		AS_FOR_TARGET=$CROSS_TARGET-as \
		LD_FOR_TARGET=$CROSS_TARGET-ld &&
	make install
}

# Rules to gen a SliTaz package suitable for Tazpkg.
genpkg_rules()
{
	mkdir -p $fs/usr
	cp -a $install/usr/bin $fs/usr
	cp -a $install/usr/lib $fs/usr
}
