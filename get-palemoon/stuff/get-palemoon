#!/bin/sh
# get Pale Moon web browser
VERSION="24.5.0"

WGET_URL=http://sourceforge.net/projects/pm4linux/files/$VERSION/\
palemoon-$VERSION.en-US.linux-i686.tar.bz2
mkdir -p $1/opt; cd $1/opt; busybox wget -O - $WGET_URL | tar -xjf -

################
DESKTOP=usr/share/applications/palemoon.desktop
cat > $1/$DESKTOP << EOA
[Desktop Entry]
Type=Application
Name=Palemoon
Exec=/opt/palemoon/palemoon %u
Icon=/opt/palemoon/browser/icons/mozicon128.png
StartupNotify=true
Categories=GTK;Network;WebBrowser;
MimeType=text/html;text/xml;application/xhtml+xml;application/xml;
EOA
################
PKGDIR="$1/var/lib/tazpkg/installed/palemoon"
mkdir -p "$PKGDIR"
cat > "$PKGDIR/receipt" << EOR
# SliTaz package receipt.

PACKED_SIZE="28.8MB"
UNPACKED_SIZE="60.9MB"
PACKAGE="palemoon"
VERSION="$VERSION"
CATEGORY="network"
SHORT_DESC="Browser based on Firefox that's optimised for performance"
MAINTAINER="al.bobylev@gmail.com"
LICENSE="MPL2"
WEB_SITE="http://sourceforge.net/projects/pm4linux"

DEPENDS="dbus-glib"
EOR
################
cat > "$PKGDIR/description.txt" << EOD
Description
===========

Pale Moon is an open source, web browser based on Firefox focusing on efficiency
by leaving out unnecessary features and making optimizations, while maintaining
compatibility with Firefox extensions and themes.

Pale Moon provides a familiar set of controls and visual feedback similar
to previous versions of Firefox, including grouped navigation buttons,
a bookmarks toolbar that is enabled by default, tabs next to page content
by default, and a functional status bar.

This is a third party build; the original project is at www.palemoon.org.
For support, check out the wiki at http://pm4linux.sf.net/wiki and the forum
at http://forum.palemoon.org.


Features
========
  * Optimized for modern processors (SSE2)
  * Based on the source code of Firefox
  * Unnecessary bloat (social API, accessibility features, WebRTC) removed
  * Support for Firefox extensions (add-ons) and themes
  * More customization and configuration options than Firefox
EOD
################
find $1/opt/palemoon -type f > "$PKGDIR/files.list"
echo "/$DESKTOP" >> "$PKGDIR/files.list"
################
find $1/opt/palemoon -type f -exec md5sum \{\} \; > "$PKGDIR/md5sum"
md5sum "/$DESKTOP" >> "$PKGDIR/md5sum"
################
