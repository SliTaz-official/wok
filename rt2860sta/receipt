# SliTaz package receipt.

PACKAGE="rt2860sta"
VERSION="1.8.0.0"
CATEGORY="system-tools"
SHORT_DESC="Kernel module rt2860sta (Wireless driver used on EeePC)."
DEPENDS="linux wireless_tools"
BUILD_DEPENDS="linux-source"
TARBALL="$PACKAGE-$VERSION.tar.bz2"
MAINTAINER="pankso@slitaz.org"
WEB_SITE="http://www.ralinktech.com/ralink/Home/Support/Linux.html"
WGET_URL="http://mirror.slitaz.org/sources/packages/r/$TARBALL"
KVER=`grep  ^VERSION= $WOK/linux-source/receipt | cut -d "=" -f2 | sed -e 's/"//g'`
EXTRAVERSION=_${KVER}

# Rules to configure and make the package.
compile_rules()
{
	cd $src
	patch -p0 < ../stuff/RT2860-Makefile.patch || exit 1
	make
	find $src/os/linux -name "*.ko" -exec lzma e '{}' '{}'.gz \;
}

# Rules to gen a SliTaz package suitable for Tazpkg.
genpkg_rules()
{
	mkdir -p $fs/lib/modules/${KVER}-slitaz/kernel/drivers/net/rt2860
	cp $src/os/linux/rt2860sta.ko.gz \
		$fs/lib/modules/${KVER}-slitaz/kernel/drivers/net/rt2860
}

post_install()
{
	depmod -a -b "$1/" ${EXTRAVERSION#_}-slitaz
}
